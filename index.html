<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>A Story Written in the Stars ✨</title>

    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- React & ReactDOM for interactivity -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

    <!-- Babel to compile JSX in the browser -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Lottie Player for high-quality, lightweight animations -->
    <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Great+Vibes&family=Poppins:wght@300;400;600&display=swap');

        body {
            font-family: 'Poppins', sans-serif;
            overflow: hidden;
            background-color: #0c0a1a;
        }

        /* Twinkling Starfield Background using SVG for performance */
        .starfield {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: -1;
        }

        .star {
            fill: white;
            animation: twinkle linear infinite;
        }

        @keyframes twinkle {

            0%,
            100% {
                opacity: 0.4;
                transform: scale(0.8);
            }

            50% {
                opacity: 1;
                transform: scale(1.1);
            }
        }

        /* General Animations */
        @keyframes fade-in {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fade-in {
            animation: fade-in 1s ease-out forwards;
        }

        @keyframes fade-in-slow {
            from {
                opacity: 0;
                transform: scale(0.95);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .animate-fade-in-slow {
            animation: fade-in-slow 0.6s ease-in-out forwards;
        }

        /* Confetti */
        .confetti-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
            z-index: 10;
        }

        .confetti-piece {
            position: absolute;
            width: 8px;
            height: 16px;
            opacity: 0;
            animation: drop 4s linear infinite;
        }

        @keyframes drop {
            0% {
                transform: translateY(-20vh) rotateZ(0deg);
                opacity: 1;
            }

            100% {
                transform: translateY(120vh) rotateZ(720deg);
                opacity: 0;
            }
        }
    </style>
</head>

<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- BACKGROUND & HELPER COMPONENTS ---

        const StarfieldBackground = () => {
            const stars = Array.from({ length: 150 }, (_, i) => {
                const cx = `${Math.random() * 100}%`;
                const cy = `${Math.random() * 100}%`;
                const r = Math.random() * 1.2 + 0.5;
                const style = {
                    animationDuration: `${Math.random() * 4 + 2}s`,
                    animationDelay: `${Math.random() * 3}s`,
                };
                return <circle key={i} className="star" cx={cx} cy={cy} r={r} style={style} />;
            });
            return <svg className="starfield">{stars}</svg>;
        };

        const Confetti = () => {
            const confettiElements = Array.from({ length: 100 }, (_, i) => {
                const style = {
                    left: `${Math.random() * 100}%`,
                    animationDuration: `${Math.random() * 3 + 2}s`,
                    animationDelay: `${Math.random() * 2}s`,
                    backgroundColor: ['#fef08a', '#fde047', '#fff', '#a5b4fc', '#c7d2fe'][Math.floor(Math.random() * 5)],
                };
                return <div key={i} className="confetti-piece" style={style}></div>;
            });
            return <div className="confetti-container">{confettiElements}</div>;
        };

        const MusicPlayer = ({ audioRef, isPlaying, onPlayPause }) => (
            <button onClick={onPlayPause} className="fixed bottom-4 right-4 bg-white/30 backdrop-blur-sm text-white p-3 rounded-full shadow-lg z-50 transform hover:scale-110 transition-all duration-300">
                <audio ref={audioRef} src="https://assets.mixkit.co/music/preview/mixkit-a-very-happy-christmas-897.mp3" loop />
                {isPlaying ? (
                    <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                ) : (
                    <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" /><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                )}
            </button>
        );

        const LottieAnimation = ({ src }) => (
            <div className="w-48 h-48 mx-auto">
                <lottie-player
                    src={src}
                    background="transparent"
                    speed="1"
                    style={{ width: '100%', height: '100%' }}
                    loop
                    autoplay
                ></lottie-player>
            </div>
        );

        // --- SCREEN COMPONENTS ---

        const IntroScreen = ({ onNext }) => (
            <div className="text-center space-y-6 animate-fade-in text-white">
                <h1 className="text-5xl md:text-7xl font-bold" style={{ fontFamily: "'Great Vibes', cursive" }}>For Rupsha</h1>
                <p className="text-lg text-indigo-200">A short story written in the stars...</p>
                <button onClick={onNext} className="bg-indigo-500 text-white font-bold py-3 px-8 rounded-full shadow-lg hover:bg-indigo-600 transform hover:scale-110 transition-all duration-300 animate-pulse">
                    Begin the Journey
                </button>
            </div>
        );

        const QuestionScreen = ({ onFinal }) => {
            const questions = [
                { lottie: "https://lottie.host/8a7b973c-3e9a-47d1-abb3-1110058b1933/i9Gg83j584.json", text: "Is your smile brighter than any star in the galaxy?" },
                { lottie: "https://lottie.host/9e410a7c-6627-4180-86c5-a0c5c192d110/Fp8L4N51hG.json", text: "If I had a universe, would you be the center of it?" },
                { lottie: "https://lottie.host/8254249a-0518-4720-9177-3860543f071f/T6A4sK8p6X.json", text: "Are we written in the constellations?" },
                { lottie: "https://lottie.host/e0600d89-43c2-475a-a78a-f55a363774b9/M8iA8Bv28X.json", text: "Final question... will you go on a date with me and create a new universe together?" }
            ];
            const noButtonResponses = ["No", "Are you sure?", "Really?", "Think again, starlight", "My cosmos is collapsing", "I'm seeing black holes...", "Don't eclipse my heart", "Okay, you win... not!"];

            const [currentIndex, setCurrentIndex] = useState(0);
            const [noCount, setNoCount] = useState(0);
            const [noBtnStyle, setNoBtnStyle] = useState({});
            const noBtnRef = useRef(null);

            const handleNoClick = () => {
                setNoCount(c => Math.min(c + 1, noButtonResponses.length - 1));
                const btn = noBtnRef.current;
                if (btn) {
                    const newX = Math.random() * (window.innerWidth - btn.offsetWidth - 20) + 10;
                    const newY = Math.random() * (window.innerHeight - btn.offsetHeight - 20) + 10;
                    setNoBtnStyle({ position: 'fixed', left: `${newX}px`, top: `${newY}px`, transition: 'all 0.3s ease' });
                }
            };

            const handleYesClick = () => {
                if (currentIndex < questions.length - 1) {
                    setCurrentIndex(i => i + 1);
                    setNoCount(0);
                    setNoBtnStyle({});
                } else {
                    onFinal();
                }
            };

            const yesBtnScale = 1 + noCount * 0.2;
            const current = questions[currentIndex];

            return (
                <div className="text-center space-y-4 animate-fade-in-slow text-white flex flex-col items-center">
                    <LottieAnimation src={current.lottie} />
                    <h2 className="text-2xl md:text-3xl font-semibold px-4 h-24 flex items-center">{current.text}</h2>
                    <div className="flex flex-col sm:flex-row justify-center items-center gap-4 pt-4">
                        <button onClick={handleYesClick} className="bg-green-500 text-white font-bold py-3 px-8 rounded-full shadow-lg hover:bg-green-600 transform transition-all duration-300" style={{ transform: `scale(${yesBtnScale})` }}>
                            Yes
                        </button>
                        <button ref={noBtnRef} onMouseEnter={handleNoClick} onClick={handleNoClick} style={noBtnStyle} className="bg-red-500 text-white font-bold py-3 px-8 rounded-full shadow-lg hover:bg-red-600 transition-all duration-300">
                            {noButtonResponses[noCount]}
                        </button>
                    </div>
                </div>
            );
        };

        const FinalScreen = () => (
            <div className="text-center space-y-4 animate-fade-in relative text-white">
                <Confetti />
                <LottieAnimation src="https://lottie.host/933a2157-7977-4253-834c-a19e51f81d11/Jg2Y853err.json" />
                <h1 className="text-5xl md:text-7xl font-bold text-yellow-300" style={{ fontFamily: "'Great Vibes', cursive" }}>Our Universe Awaits!</h1>
                <p className="text-xl text-indigo-200">You've made my stars align, Rupsha. I love you to the moon and back. ❤️</p>
            </div>
        );

        // --- MAIN APPLICATION ---
        function App() {
            const [screen, setScreen] = useState('intro');
            const [isPlaying, setIsPlaying] = useState(false);
            const audioRef = useRef(null);

            const handlePlayPause = () => {
                if (audioRef.current.paused) {
                    audioRef.current.play().then(() => setIsPlaying(true)).catch(e => console.error("Audio play failed:", e));
                } else {
                    audioRef.current.pause();
                    setIsPlaying(false);
                }
            };

            const renderScreen = () => {
                switch (screen) {
                    case 'intro':
                        return <IntroScreen onNext={() => { setScreen('questions'); if (!isPlaying) handlePlayPause(); }} />;
                    case 'questions':
                        return <QuestionScreen onFinal={() => setScreen('final')} />;
                    case 'final':
                        return <FinalScreen />;
                    default:
                        return null;
                }
            };

            return (
                <React.Fragment>
                    <StarfieldBackground />
                    <MusicPlayer audioRef={audioRef} isPlaying={isPlaying} onPlayPause={handlePlayPause} />
                    <div className="flex items-center justify-center h-screen w-screen p-4">
                        <main className="max-w-lg w-full bg-slate-800/25 backdrop-blur-xl border border-white/20 rounded-3xl shadow-2xl p-8 md:p-12 transition-all duration-500">
                            {renderScreen()}
                        </main>
                    </div>
                </React.Fragment>
            );
        }

        // --- Render the App ---
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>